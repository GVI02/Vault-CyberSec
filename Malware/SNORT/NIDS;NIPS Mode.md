#snort  #malware 

###### <span class="purple-highlight-light">Description</span>

SNORT NIDS/NIPS blocks / allows traffic based on rules added to a configuration file.
Default files are located in **/etc/snort/**.

###### <span class="purple-highlight-light">Flags</span>

| Flag | Description                                                                                                                                                                                                                                                                                                    |
| ---- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| -c   | Defining the configuration file                                                                                                                                                                                                                                                                                |
| -T   | Testing the configuration file                                                                                                                                                                                                                                                                                 |
| -N   | Disabble logging                                                                                                                                                                                                                                                                                               |
| -D   | Background mode.                                                                                                                                                                                                                                                                                               |
| -A   | Alert modes<br>**full**: Full alert mode. All possible information. Default mode.<br>**fast**: Alert message, timestamp, src and dst IP and ports<br>**console**: Fast style alerts on the console screen.<br>**cmg**: Basic header details with payload in hex and text format.<br>**none**: Disable alerting |
Full and Fast alert modes have no console output. Their output is saved in an **alert** file in the directory where snort is ran from.


###### <span class="purple-highlight-light">IPS mode</span>

IPS mode is activated using the -Q --daq afpacket parameters or by editing the .conf file. SNORT IPS requires at least 2 interfaces to work.

```shell
sudo snort -c /etc/snort/snort.conf -Q --daq afpacket -i eth0:eth1
```

###### <span class="purple-highlight-light">Rule Structure</span>

![[Pasted image 20250519133048.png]]



###### <span class="blue-highlight-light">Rule Examples</span>

The following rule generates an alert every time an ICMP packet is detected.
```snort
alert icmp any any <> any any (msg: "ICMP Packet Found"; sid: 100001; rev:1;)
```

###### <span class="blue-highlight-light">Examples</span>

Run SNORT NIPS/NIPS in **cmg** alert mode
```shell
sudo snort -c /etc/snort/snort.conf -A cmg
```

Test rules without configuration file (slower performance)
```shell
sudo snort -c /etc/short/rules/local.rules -A console
```

Run SNORT NIDS in full alert mode and save traffic to local directory
```shell
sudo snort -c /etc/snort/snot.conf -A full -l .
```

Read pcap file with SNORT NIDS.
```shell
sudo snort -c /etc/snort/snort.conf -A console -r cap.pcap
```

Read list of pcap files with SNORT NIDS.
```shell
sudo snort -c /etc/snort/snort.conf -A console --pcap-list="icmp.pcap http.pcap"
```

Read pcap file with SNORT NIDS and log traffic output to file.
```shell
sudo snort -c /etc/snort/snort.conf -A full -l . -r cap.pcap
```

