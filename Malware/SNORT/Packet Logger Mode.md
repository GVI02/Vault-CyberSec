#snort #malware 

You can use Snort as a sniffer and log the sniffed packets via logger mode. You only need to use the packet logger mode parameters, and Snort does the rest to accomplish this.

###### <span class="purple-highlight-light">Flags</span>

| Flag        | Description                                                                                                                                                                      |
| ----------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| -l          | Logger mode, target **log and alert** output directory. Default output folder is **/var/log/snort**<br><br>The default action is to dump as tcpdump format in **/var/log/snort** |
| -K ASCII    | Log packets in ASCII format.                                                                                                                                                     |
| -r          | Reading option, read the dumped logs in Snort.                                                                                                                                   |
| --pcap-list | Specify a list of capture files to read.                                                                                                                                         |
| --pcap-show | When analyzing multiple pcap files show the name of the file before its associated output.                                                                                       |
| -n          | Specify the number of packets that will process/read. Snort will stop after reading the specified number of packets.                                                             |
Flags for output modification from [[Sniffer Mode]] also apply here.

>[!important]
>SNORT requires **root** privileges in order to sniff traffic.

###### <span class="blue-highlight-light">Examples</span>

Capture packets to current directory
```shell
sudo snort -dev -l .
```

Log packets in ASCII format and save in the current directory
```shell
sudo snort -K ASCII -dev -l .
```

Read **binary** log file in SNORT
```shell
sudo snort -r snort.log.1747641691
```

Read **binary** log file in [[Tcpdump]] (also can be opened in Wireshark)
```shell
sudo tcpdump -r snort.log.1747641691 -ntc 10
```

Reading capture files with SNORT also allows the usage of Berkeley Packet Filters (BPF).
```shell
sudo snort -r logname.log 'udp and port 53'
sudo snort -r logname.log icmp
sudo snort -r logname.log tcp
```

Read only the first 10 packets of a file
```shell
sudo snort -dvr logname.log -n 10
```